import pickle
from pymongo import MongoClient

from .settings import CVE_PATH


def get_nvd_database():
    mongo_client = MongoClient()
    vulnerability_database = mongo_client['vulnerability']
    return vulnerability_database['nvd']


def save_cve(cve):
    return pickle.dump(cve, open(CVE_PATH, 'wb'), protocol=-1)


def load_cve():
    return pickle.load(open(CVE_PATH, 'rb'))


def define_limit_score(minimum_score):

    def limit_score(vendor_pack):
        match_score = vendor_pack[1]
        return match_score >= minimum_score

    return limit_score
