import pickle
from pymongo import MongoClient

from .settings import CVE_PATH


def get_nvd_database():
    mongo_client = MongoClient()
    vulnerability_database = mongo_client['vulnerability']
    return vulnerability_database['nvd']


def load_cve():
    return pickle.load(open(CVE_PATH, 'rb'))


def save_cve(cve):
    return pickle.dump(cve, open(CVE_PATH, 'wb'), protocol=-1)
