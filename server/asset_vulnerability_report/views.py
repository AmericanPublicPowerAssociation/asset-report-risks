from pyramid.view import view_config

from .routines import (
    load_cve,
    get_similar_vendor_names)


CVE = load_cve()
MINIMUM_SIMILARITY = 80
MAXIMUM_COUNT = 10


@view_config(
    route_name='vendor_names.json',
    renderer='json',
    request_method='GET')
def get_vendor_names_json(request):
    params = request.params
    asset_type_id = params.get('typeId', '*')
    vendor_name = params.get('vendorName', '')
    component_type = '*' if asset_type_id == 'X' else 'h'
    return get_similar_vendor_names(
        CVE, component_type, vendor_name, MINIMUM_SIMILARITY,
        MAXIMUM_COUNT)


@view_config(
    route_name='product_names.json',
    renderer='json',
    request_method='GET')
def get_product_names_json(request):
    pass


@view_config(
    route_name='product_versions.json',
    renderer='json',
    request_method='GET')
def get_product_versions_json(request):
    pass


@view_config(
    route_name='vulnerabilities.json',
    renderer='json',
    request_method='GET')
def get_vulnerabilities_json(request):
    pass
